
(function(d){function l(b,a,c){a="("+c.replace(m,"\\$1")+")";return b.replace(new RegExp(a,"gi"),"<strong>$1</strong>")}function i(b,a){this.el=d(b);this.el.attr("autocomplete","off");this.suggestions=[];this.data=[];this.badQueries=[];this.selectedIndex=-1;this.currentValue=this.el.val();this.intervalId=0;this.cachedResponse=[];this.onChangeInterval=null;this.ignoreValueChange=false;this.serviceUrl=a.serviceUrl;this.isLocal=false;this.options={autoSubmit:false,minChars:1,maxHeight:300,deferRequestBy:0,width:0,highlight:true,params:{},fnFormatResult:l,delimiter:null,zIndex:9999};this.initialize();this.setOptions(a)}var m=new RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");d.fn.autocomplete=function(b){return new i(this.get(0)||d("<input />"),b)};i.prototype={killerFn:null,initialize:function(){var b,a,c;b=this;a=Math.floor(Math.random()*1048576).toString(16);c="Autocomplete_"+a;this.killerFn=function(e){if(d(e.target).parents(".autocomplete").size()===0){b.killSuggestions();b.disableKillerFn()}};if(!this.options.width)this.options.width=this.el.width();this.mainContainerId="AutocompleteContainter_"+a;d('<div id="'+this.mainContainerId+'" style="position:absolute;z-index:9999;"><div class="autocomplete-w1"><div class="autocomplete" id="'+c+'" style="display:none; width:300px;"></div></div></div>').appendTo("body");this.container=d("#"+c);this.fixPosition();window.opera?this.el.keypress(function(e){b.onKeyPress(e)}):this.el.keydown(function(e){b.onKeyPress(e)});this.el.keyup(function(e){b.onKeyUp(e)});this.el.blur(function(){b.enableKillerFn()});this.el.focus(function(){b.fixPosition()})},setOptions:function(b){var a=this.options;d.extend(a,b);if(a.lookup){this.isLocal=true;if(d.isArray(a.lookup))a.lookup={suggestions:a.lookup,data:[]}}d("#"+this.mainContainerId).css({zIndex:a.zIndex});this.container.css({maxHeight:a.maxHeight+"px",width:a.width})},clearCache:function(){this.cachedResponse=[];this.badQueries=[]},disable:function(){this.disabled=true},enable:function(){this.disabled=false},fixPosition:function(){var b=this.el.offset();d("#"+this.mainContainerId).css({top:b.top+this.el.innerHeight()+"px",left:b.left+"px"})},enableKillerFn:function(){d(document).bind("click",this.killerFn)},disableKillerFn:function(){d(document).unbind("click",this.killerFn)},killSuggestions:function(){var b=this;this.stopKillSuggestions();this.intervalId=window.setInterval(function(){b.hide();b.stopKillSuggestions()},300)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},onKeyPress:function(b){if(!(this.disabled||!this.enabled)){switch(b.keyCode){case 27:this.el.val(this.currentValue);this.hide();break;case 9:case 13:if(this.selectedIndex===-1){this.hide();return}this.select(this.selectedIndex);if(b.keyCode===9)return;break;case 38:this.moveUp();break;case 40:this.moveDown();break;default:return}b.stopImmediatePropagation();b.preventDefault()}},onKeyUp:function(b){if(!this.disabled){switch(b.keyCode){case 38:case 40:return}clearInterval(this.onChangeInterval);if(this.currentValue!==this.el.val())if(this.options.deferRequestBy>0){var a=this;this.onChangeInterval=setInterval(function(){a.onValueChange()},this.options.deferRequestBy)}else this.onValueChange()}},onValueChange:function(){clearInterval(this.onChangeInterval);this.currentValue=this.el.val();var b=this.getQuery(this.currentValue);this.selectedIndex=-1;if(this.ignoreValueChange)this.ignoreValueChange=false;else b===""||b.length<this.options.minChars?this.hide():this.getSuggestions(b)},getQuery:function(b){var a;a=this.options.delimiter;if(!a)return d.trim(b);b=b.split(a);return d.trim(b[b.length-1])},getSuggestionsLocal:function(b){var a,c,e,g,f;c=this.options.lookup;e=c.suggestions.length;a={suggestions:[],data:[]};b=b.toLowerCase();for(f=0;f<e;f++){g=c.suggestions[f];if(g.toLowerCase().indexOf(b)===0){a.suggestions.push(g);a.data.push(c.data[f])}}return a},getSuggestions:function(b){var a,c;if((a=this.isLocal?this.getSuggestionsLocal(b):this.cachedResponse[b])&&d.isArray(a.suggestions)){this.suggestions=a.suggestions;this.data=a.data;this.suggest()}else if(!this.isBadQuery(b)){c=this;c.options.params.query=b;d.get(this.serviceUrl,c.options.params,function(e){c.processResponse(e)},"text")}},isBadQuery:function(b){for(var a=this.badQueries.length;a--;)if(b.indexOf(this.badQueries[a])===0)return true;return false},hide:function(){this.enabled=false;this.selectedIndex=-1;this.container.hide()},suggest:function(){if(this.suggestions.length===0)this.hide();else{var b,a,c,e,g,f,j,k;b=this;a=this.suggestions.length;e=this.options.fnFormatResult;g=this.getQuery(this.currentValue);j=function(h){return function(){b.activate(h)}};k=function(h){return function(){b.select(h)}};this.container.hide().empty();for(f=0;f<a;f++){c=this.suggestions[f];c=d((b.selectedIndex===f?'<div class="selected"':"<div")+' title="'+c+'">'+e(c,this.data[f],g)+"</div>");c.mouseover(j(f));c.click(k(f));this.container.append(c)}this.enabled=true;this.container.show()}},processResponse:function(b){var a;try{a=eval("("+b+")")}catch(c){return}if(!d.isArray(a.data))a.data=[];if(!this.options.noCache){this.cachedResponse[a.query]=a;a.suggestions.length===0&&this.badQueries.push(a.query)}if(a.query===this.getQuery(this.currentValue)){this.suggestions=a.suggestions;this.data=a.data;this.suggest()}},activate:function(b){var a,c;a=this.container.children();this.selectedIndex!==-1&&a.length>this.selectedIndex&&d(a.get(this.selectedIndex)).removeClass();this.selectedIndex=b;if(this.selectedIndex!==-1&&a.length>this.selectedIndex){c=a.get(this.selectedIndex);d(c).addClass("selected")}return c},deactivate:function(b,a){b.className="";if(this.selectedIndex===a)this.selectedIndex=-1},select:function(b){var a;if(a=this.suggestions[b]){this.el.val(a);if(this.options.autoSubmit){a=this.el.parents("form");a.length>0&&a.get(0).submit()}this.ignoreValueChange=true;this.hide();this.onSelect(b)}},moveUp:function(){if(this.selectedIndex!==-1)if(this.selectedIndex===0){this.container.children().get(0).className="";this.selectedIndex=-1;this.el.val(this.currentValue)}else this.adjustScroll(this.selectedIndex-1)},moveDown:function(){this.selectedIndex!==this.suggestions.length-1&&this.adjustScroll(this.selectedIndex+1)},adjustScroll:function(b){var a,c,e;a=this.activate(b).offsetTop;c=this.container.scrollTop();e=c+this.options.maxHeight-25;if(a<c)this.container.scrollTop(a);else a>e&&this.container.scrollTop(a-this.options.maxHeight+25);this.el.val(this.getValue(this.suggestions[b]))},onSelect:function(b){var a,c;a=this.options.onSelect;c=this.suggestions[b];b=this.data[b];this.el.val(this.getValue(c));d.isFunction(a)&&a(c,b,this.el)},getValue:function(b){var a,c;a=this.options.delimiter;if(!a)return b;c=this.currentValue;a=c.split(a);if(a.length===1)return b;return c.substr(0,c.length-a[a.length-1].length)+b}}})(jQuery);jQuery(function($){cache={'domain':{},'store_name':{},'title':{}};$('#tAutoComplete').autocomplete({minLength:1,source:function(request,response){alert('here');var cacheType=$('#sAutoComplete').val();if(request['term']in cache[cacheType]){response($.map(cache[cacheType][request['term']],function(item){return{'label':item[cacheType],'value':item[cacheType]}}));return 0;}}});$('#fSubmitSearch').submit(function(){$('#aSearch').click();return false;});$('#aSearch').click(function(){$.post('/accounts/search/',{_nonce:$('#_ajax_search').val(),'s':$('#tAutoComplete').val()},ajaxResponse,'json');});$('#sState').change(function(){$.post('/accounts/store-session/',{'_nonce':$('#_ajax_change_state').val(),'s':$(this).val()},ajaxResponse,'json');});});var sparrow=function(context){$('input[tmpval],textarea[tmpval]',context).each(function(){$(this).focus(function(){if($(this).val()==$(this).attr('tmpval'))
$(this).val('').removeClass('tmpval');}).blur(function(){var value=$(this).val(),tmpValue=$(this).attr('tmpval');if(0==value.length||value==tmpValue)
$(this).val(tmpValue).addClass('tmpval');});if(!$(this).val().length)
$(this).val($(this).attr('tmpval')).addClass('tmpval');});var tables=$('table[ajax],table.dt',context);if(tables.length)
head.js('/resources/js_single/?f=jquery.datatables',function(){tables.addClass('dt').each(function(){var aPerPage=$(this).attr('perPage').split(','),opts='',ths=$(this).find('th').append('<img src="/images/trans.gif" width="9" height="8" />'),sorting=new Array(),columns=new Array(),s='',c='',a=$(this).attr('ajax');for(var i in aPerPage){opts+='<option value="'+aPerPage[i]+'">'+aPerPage[i]+'</option>';}
if(ths.length){for(var i=0;i<ths.length;i++){if(s=$(ths[i]).attr('sort')){var direction=(-1==s.search('desc'))?'asc':'desc';sorting[s.replace(' '+direction,'')-1]=[i,direction];}
if(c=$(ths[i]).attr('column')){columns.push({'sType':c});}else{columns.push(null);}}}else{sorting=[[0,'asc']];}
var settings={bAutoWidth:false,iDisplayLength:parseInt(aPerPage[0]),oLanguage:{sLengthMenu:'<select>'+opts+'</select>',sInfo:"_START_ - _END_ of _TOTAL_"},aaSorting:sorting,aoColumns:columns,fnDrawCallback:function(){sparrow($(this).find('tr:last').addClass('last').end());},sDom:'<"top"lfr>t<"bottom"pi>'};if(a)
settings.bProcessing=1,settings.bServerSide=1,settings.sAjaxSource=a;$(this).dataTable(settings);});});var dialogs=$('a[rel=dialog]',context);if(dialogs.length)
head.js('/resources/js_single/?f=jquery.boxy',function(){dialogs.click(function(e){e.preventDefault();var dialogData=$(this).attr('href').split('#'),content=$('#'+dialogData[1]),settings={title:$(this).attr('title'),behaviours:sparrow};if(content.length&&'0'!=$(this).attr('cache')){new Boxy(content,settings);}else{$('body').append('<div id="'+dialogData[1]+'" class="dialog" />');content=$('#'+dialogData[1]);content.load(dialogData[0],function(){new Boxy(content,settings);});}});});$('a[ajax]',context).click(function(e){e.preventDefault();var confirmQuestion=$(this).attr('confirm');if(confirmQuestion&&!confirm(confirmQuestion))
return
$.get($(this).attr('href'),ajaxResponse,'json');}).removeAttr('ajax');var RTEs=$('textarea[rte]',context);if(RTEs.length)
head.js('/ckeditor/ckeditor.js','/ckeditor/adapters/jquery.js',function(){RTEs.ckeditor({autoGrow_minHeight:100,resize_minHeight:100,height:100,toolbar:[['Bold','Italic','Underline'],['JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock'],['NumberedList','BulletedList','Table'],['Format'],['Link','Unlink'],['Source']]});});var ajaxForms=$('form[ajax]',context);if(ajaxForms.length)
head.js('/resources/js_single/?f=jquery.form',function(){ajaxForms.ajaxForm({dataType:'json',success:ajaxResponse});});}
$.fn.sparrow=sparrow;head.ready(function(){sparrow($('body'));});function ajaxResponse(response){if(response['success']){if(response['refresh']){window.location=window.location;}else if('object'==typeof(response['jquery'])){head.js('/resources/js_single/?f=jquery.php',function(){php(response['jquery']);});}}else{if(response['error'])
alert(response['error']);}}(function($){$.fn.extend({notify:function(options){var settings=$.extend({type:'sticky',fade:5000,speed:500,onDemandButtonHeight:35},options);return this.each(function(){var wrapper=$(this);if(0!=settings.fade)
setTimeout(function(){wrapper.fadeOut(500,function(){$(this).remove();});},settings.fade);var ondemandBtn=$('.ondemand-button');var dh=-35;var w=wrapper.outerWidth()-ondemandBtn.outerWidth();ondemandBtn.css('left',w).css('margin-top',dh+"px");var h=-wrapper.outerHeight();wrapper.addClass(settings.type).css('margin-top',h).show();if(settings.type!='ondemand'){wrapper.stop(true,false).animate({marginTop:0},settings.speed);}
else{ondemandBtn.stop(true,false).animate({marginTop:0},settings.speed);}
var closeBtn=$('.close',wrapper);closeBtn.click(function(){if(settings.type=='ondemand'){wrapper.stop(true,false).animate({marginTop:h},settings.speed,function(){wrapper.hide();ondemandBtn.stop(true,false).animate({marginTop:0},settings.speed);});}
else{wrapper.stop(true,false).animate({marginTop:h},settings.speed,function(){wrapper.hide();});}});if(settings.type=='floated'){$(document).scroll(function(e){wrapper.stop(true,false).animate({top:$(document).scrollTop()},settings.speed);}).resize(function(e){c
wrapper.stop(true,false).animate({top:$(document).scrollTop()},settings.speed);});}
else if(settings.type=='ondemand'){ondemandBtn.click(function(){$(this).animate({marginTop:dh},settings.speed,function(){wrapper.show().animate({marginTop:0},settings.speed,function(){});})});}});}});})(jQuery);jQuery(function($){$('.notification').notify();$('body').on('click','a[href^=#]',function(e){e.preventDefault();});$('#aTicket').click(function(){var a=$(this);if(a.hasClass('loaded')){new Boxy($('#dTicketPopup'),{title:a.attr('title')});return;}
head.js('/resources/js_single/?f=jquery.boxy','/resources/js_single/?f=jquery.form',function(){a.addClass('loaded');new Boxy($('#dTicketPopup'),{title:a.attr('title')});$('#fCreateTicket').addClass('ajax').ajaxForm({dataType:'json',beforeSubmit:function(){var tTicketSummary=$('#tTicketSummary'),summary=tTicketSummary.val(),taTicket=$('#taTicket'),message=taTicket.val();if(!summary.length||summary==tTicketSummary.attr('tmpval')){alert(tTicketSummary.attr('error'));return false;}
if(!message.length||message==taTicket.attr('tmpval')){alert(taTicket.attr('error'));return false;}
return true;},success:ajaxResponse});});});$('#bCreateTicket').click(function(){$('#fCreateTicket').submit();});$('#dTicketPopup .expander').click(function(){if($(this).hasClass('open')){$(this).removeClass('open').addClass('close');$('#'+$(this).attr('rel')).show();}else{$(this).removeClass('close').addClass('open');$('#'+$(this).attr('rel')).hide();}});});