function luhn_check(a){for (var e=a.replace(/\D/g,"").length,b=e%2,c=0,d=0;d<e;d++){var f=a.charAt(d);d%2==b&&(f*=2,f>9&&(f-=9));c+=parseInt(f,10)}return c%10==0?!0:!1}function in_array(a,e,b){var c=!1,d,b=!!b;for (d in e)if (b&&e[d]===a||!b&&e[d]==a){c=!0;break}return c} function Validator(a){this.fObj=document.forms[a];var e=arguments.length>0?arguments[1]:!1;if (!this.fObj)return alert("Error: could not get form object "+a),!1;this.fObj.onsubmit?(this.fObj.old_onsubmit=this.fObj.onsubmit,this.fObj.onsubmit=null):this.fObj.old_onsubmit=null;this.vElements=[];e?this.fObj.trigger=form_submit_handler:this.fObj.onsubmit=form_submit_handler;this.addValidation=add_validation;this.removeValidation=remove_validation;this.clearAllValidations=clear_all_validations;this.clearValidations= clear_validations;this.restoreValidations=restore_validations;return!0}function clear_all_validations(){for (var a=0;a<this.fObj.elements.length;a++)this.fObj.elements[a].vSet=null}function clear_validations(a,e){for (var b=start=e?e:0;b<this.fObj.elements.length;b++)if (this.fObj.elements[b].val&&in_array(this.fObj.elements[b].val.vSet[0][0],a))this.fObj.elements[b].val.oldSet=this.fObj.elements[b].val.vSet,this.fObj.elements[b].val.vSet=null} function restore_validations(a,e){for (var b=start=e?e:0;b<this.fObj.elements.length;b++)if (this.fObj.elements[b].val&&this.fObj.elements[b].val.oldSet)this.fObj.elements[b].val.vSet=this.fObj.elements[b].val.oldSet}function form_submit_handler(){for (var a=0;a<this.elements.length;a++)if (this.elements[a].val&&this.elements[a].val.vSet&&!this.elements[a].val.validate(this))return!1;return!0}function remove_validation(a){if ((a=this.fObj[a])&&a.val)a.val.oldSet=a.val.vSet,a.val.vSet=null} function add_validation(a,e,b){if (this.fObj){var c=this.fObj[a];if (c)c.val?c.val.oldSet?c.val.vSet=c.val.oldSet:c.val.add(a,e,b):(c.val=new Val,c.val.add(a,e,b));else if (elementArray=a.split("|"),elementArray.length>1)if (!this.fObj[elementArray[0]]||!this.fObj[elementArray[1]])alert("Error: Could not get the input objects");else{if (!this.fObj[elementArray[0]].val)this.fObj[elementArray[0]].val=new Val;this.fObj[elementArray[0]].val.add(a,e,b)}else alert("Error: Could not get the input object named: "+ a)}else alert("Error: the form object is not set properly")}function Val(){this.vSet=[];this.add=addVal;this.validate=validate}function addVal(a,e,b){this.vSet[this.vSet.length]=[a,e,b]}function validate(a){for (i=0;i<this.vSet.length;i++)if (!checkValidation(this.vSet[i][0],this.vSet[i][1],this.vSet[i][2],a))return elementArray=this.vSet[i][0].split("|"),a[elementArray[0]].focus(),!1;return!0} function checkValidation(a,e,b,c){e=e.split("=");command=e[0];cmdvalue=e.length>1?e[1]:"";e={alnum:/[^A-Za-z0-9\ ]/,alnumhyphen:/[^A-Za-z0-9\-_]/,alpha:/[^A-Za-z]/,cc:/^(3[47]|4|5[1-5]|6011)/,csv:/[^-a-zA-Z0-9,\s]/,custom:/[^A-Za-z0-9\042\047\055\057\ _$.,!?()]/,date:/^[\d]{4}-[\d]{2}-[\d]{2}$/,email:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,"float":/[^0-9\.]/,img:/^[0-9A-Za-z_ \-]+(.[jJ][pP][gG]|.[jJ][pP][eE][gG]|.[gG][iI][fF]|.[pP][nN][gG])$/, num:/[^0-9]/,phone:/[^0-9\- ()]/,URL:/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,4}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/,zip:/[^-0-9]/};switch (command){case "alnum":case "alphanumeric":var d=c[a].value.search(e.alnum);if (c[a].value.length>0&&d>=0){if (!b||b.length==0)b=a+" must be alpha-numeric";alert(b+"\n [Error character position "+eval(d+1)+ "]");return!1}break;case "alnumhyphen":d=c[a].value.search(e.alnumhyphen);if (c[a].value.length>0&&d>=0){if (!b||b.length==0)b=a+" may only contain alpha-numeric, hyphen and underscore characters";alert(b+"\n [Error character position "+eval(d+1)+"]");return!1}break;case "alphabetic":case "alpha":d=c[a].value.search(e.alpha);if (c[a].value.length>0&&d>=0){if (!b||b.length==0)b=a+" may only contain letters (no symbols or numbers)";alert(b+"\n [Error character position "+eval(d+1)+"]");return!1}break;case "cc":case "credit":case "creditcard":b= c[a].value.replace(/\D/g,"");a=b.length;c=b[0];if (null!=e.cc.exec(b)){switch (c){case "4":if (13!=a&&16!=a)return alert("The credit card number you entered is not valid. Please try again."),!1;else d=1;break;case "5":if (16!=a)return alert("The credit card number you entered is not valid. Please try again."),!1;else d=2;break;case "6":if (16!=a)return alert("The credit card number you entered is not valid. Please try again."),!1;else d=3;break;case "3":if (15!=a)return alert("The credit card number you entered is not valid. Please try again."), !1;else d=4}if (luhn_check(b)){if (typeof d!="undefined")document.getElementById("sCCType").options[d].selected=!0}else return alert("The credit card number you entered is not valid. Please try again."),!1}else return alert("The credit card number you entered is not valid. Please try again."),!1;break;case "csv":d=c[a].value.search(e.csv);if (c[a].value.length>0&&d>=0){if (!b||b.length==0)b=a+" may only contain alpha-numeric characters, '-' and '_', separated by commas";alert(b);return!1}break;case "custom":d= c[a].value.search(e.custom);if (c[a].value.length>0&&d>=0){if (!b||b.length==0)b=a+" may only contain alpha-numeric, {'}, {,}, {.}, {&}, {/}, {-}, {\"}, {?}, {(}, {)}, {_} and {!} characters";alert(b+"\n [Error character position "+eval(d+1)+"]");return!1}break;case "date":if (c[a].value.length>0&&c[a].value!=c[a].getAttribute("tmpval")&&(d=c[a].value.match(e.date),d==null)){if (!b||b.length==0)b=a+" must contain a valid date";alert(b);return!1}break;case "email":if (c[a].value.length>0&&(d=c[a].value.match(e.email), d==null)){if (!b||b.length==0)b=a+" must contain a valid email address";alert(b);return!1}break;case "extension":case "ext":d=cmdvalue.split("|");c=c[a].value.split(".")[c[a].value.split(".").length-1].toLowerCase();if (d.indexOf(c)==-1){if (!b||b.length==0)b=a+" may only contain the following file types: "+d;alert(b+'\n[Current file type: "'+c+'" ]');return!1}break;case "float":d=c[a].value.search(e["float"]);if (c[a].value.length>0&&d>=0&&c[a].value!=c[a].getAttribute("tmpval")){if (!b||b.length==0)b= a+" may only contain numbers and a period";alert(b+"\n [Error character position "+eval(d+1)+"]");return!1}break;case "gt":case "greaterthan":if (isNaN(c[a].value))return alert(a+" must be numeric"),!1;if (eval(c[a].value)<=eval(cmdvalue)){if (!b||b.length==0)b=a+" must contain a number greater than "+cmdvalue;alert(b);return!1}break;case "image":case "img":d=c[a].value.split("\\")[c[a].value.split("\\").length-1].match(e.img);if (c[a].value.length>0&&d>=0){if (!b||b.length==0)b=a+" may only hold an image with extensions jpg, jpeg, gif or png."; alert(b+"\n [Error character position "+eval(d+1)+"]");return!1}break;case "lt":case "lessthan":if (isNaN(c[a].value))return alert(a+" must be numeric"),!1;if (eval(c[a].value)>=eval(cmdvalue)){if (!b||b.length==0)b=a+" must contain a number less than "+cmdvalue;alert(b);return!1}break;case "match":a=a.split("|");if (c[a[0]].value!=c[a[1]].value){if (!b||b.length==0)b=a[0]+" and "+a[1]+" must match";alert(b);return!1}break;case "maxlength":case "maxlen":if (eval(c[a].value.length)>eval(cmdvalue)){if (!b|| b.length==0)b=a+" may not be longer than "+cmdvalue+" characters";alert(b+"\n[Current length = "+c[a].value.length+" ]");return!1}break;case "minlength":case "minlen":if (eval(c[a].value.length)<eval(cmdvalue)){if (!b||b.length==0)b=a+" may not be shorter than "+cmdvalue+" characters";alert(b+"\n[Current length = "+c[a].value.length+" ]");return!1}break;case "num":case "numeric":d=c[a].value.search(e.num);if (c[a].value.length>0&&d>=0&&c[a].value!=c[a].getAttribute("tmpval")){if (!b||b.length==0)b=a+ " must be a number";alert(b+"\n [Error character position "+eval(d+1)+"]");return!1}break;case "phone":d=c[a].value.search(e.phone);if (c[a].value.length>0&&d>=0){if (!b||b.length==0)b=a+" must contain a valid phone number";alert(b+"\n [Error character position "+eval(d+1)+"]");return!1}break;case "regexp":if (c[a].value.length>0&&!c[a].value.match(cmdvalue)){if (!b||b.length==0)b=a+" contains invalid characters";alert(b);return!1}break;case "req":case "required":if (eval(c[a].value.length)==0||c[a].type== "checkbox"&&c[a].checked==!1){if (!b||b.length==0)b=a+" is a required field";alert(b);return!1}break;case "URL":if (c[a].value.length>0&&(d=c[a].value.match(e.URL),d==null)){if (!b||b.length==0)b=a+" must contain a valid URL";alert(b);return!1}break;case "val":if (c[a].value!=cmdvalue&&c[a].value.length>0){if (!b||b.length==0)b=a+'" must contain the following value "'+cmdvalue+'"';alert(b);return!1}break;case "!val":if (c[a].value==cmdvalue&&c[a].value.length>0){if (!b||b.length==0)b=a+'" must not contain the following value "'+ cmdvalue+'"';alert(b);return!1}break;case "zip":if (d=c[a].value.search(e.zip),c[a].value.length>0&&d>=0){if (!b||b.length==0)b=a+" must contain a valid zip code";alert(b+"\n [Error character position "+eval(d+1)+"]");return!1}}return!0};