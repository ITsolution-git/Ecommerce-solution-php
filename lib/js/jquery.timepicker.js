(function(f){"function"===typeof define&&define.amd?define(["jquery"],f):f(jQuery)})(function(f){function y(a){a.minTime&&(a.minTime=g(a.minTime));a.maxTime&&(a.maxTime=g(a.maxTime));a.durationTime&&(a.durationTime=g(a.durationTime));if(0<a.disableTimeRanges.length){for(var c in a.disableTimeRanges)a.disableTimeRanges[c]=[g(a.disableTimeRanges[c][0]),g(a.disableTimeRanges[c][1])];a.disableTimeRanges=a.disableTimeRanges.sort(function(a,c){return a[0]-c[0]})}return a}function u(a){a=f(a.target);0=== a.closest(".ui-timepicker-input").length&&0===a.closest(".ui-timepicker-wrapper").length&&(j.hide(),f("body").unbind(".ui-timepicker"),f(window).unbind(".ui-timepicker"))}function r(a,c,b){if(!b&&0!==b)return!1;var d=!1,e=30*a.data("timepicker-settings").step;c.find("li").each(function(a,c){var g=f(c),j=g.data("time")-b;if(Math.abs(j)<e||j==e)return d=g,!1});return d}function v(a,c){c.find("li").removeClass("ui-timepicker-selected");var b=g(l(a));if(b&&(b=r(a,c,b))){var d=b.offset().top-c.offset().top; (d+b.outerHeight()>c.outerHeight()||0>d)&&c.scrollTop(c.scrollTop()+b.position().top-b.outerHeight());b.addClass("ui-timepicker-selected")}}function z(){if(""!==this.value){var a=f(this),c=g(this.value);if(null===c)a.trigger("timeFormatError");else{var b=a.data("timepicker-settings");null!==b.minTime&&c<b.minTime?a.trigger("timeRangeError"):null!==b.maxTime&&c>b.maxTime&&a.trigger("timeRangeError");if(b.forceRoundTime)var d=c%(60*b.step),c=d>=30*b.step?c+(60*b.step-d):c-d;c=t(c,b.timeFormat);m(a, c)}}}function l(a){return a.is("input")?a.val():a.data("ui-timepicker-value")}function m(a,c){a.is("input")?a.val(c):a.data("ui-timepicker-value",c)}function A(a){var c=f(this),b=c.data("timepicker-list");if(!b||!b.is(":visible"))if(40==a.keyCode)c.focus();else return!0;switch(a.keyCode){case 13:return w(c)&&j.hide.apply(this),a.preventDefault(),!1;case 38:var d=b.find(".ui-timepicker-selected");d.length?d.is(":first-child")||(d.removeClass("ui-timepicker-selected"),d.prev().addClass("ui-timepicker-selected"), d.prev().position().top<d.outerHeight()&&b.scrollTop(b.scrollTop()-d.outerHeight())):(b.find("li").each(function(a,b){if(0<f(b).position().top)return d=f(b),!1}),d.addClass("ui-timepicker-selected"));return!1;case 40:return d=b.find(".ui-timepicker-selected"),0===d.length?(b.find("li").each(function(a,b){if(0<f(b).position().top)return d=f(b),!1}),d.addClass("ui-timepicker-selected")):d.is(":last-child")||(d.removeClass("ui-timepicker-selected"),d.next().addClass("ui-timepicker-selected"),d.next().position().top+ 2*d.outerHeight()>b.outerHeight()&&b.scrollTop(b.scrollTop()+d.outerHeight())),!1;case 27:b.find("li").removeClass("ui-timepicker-selected");b.hide();break;case 9:j.hide()}}function B(a){var c=f(this),b=c.data("timepicker-list");if(!b||!b.is(":visible"))return!0;switch(a.keyCode){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:v(c,b)}}function w(a){var c=a.data("timepicker-settings"),b=a.data("timepicker-list"),d=null, e=b.find(".ui-timepicker-selected");if(e.hasClass("ui-timepicker-disabled"))return!1;e.length?d=e.data("time"):l(a)&&(d=g(l(a)),v(a,b));null!==d&&(c=t(d,c.timeFormat),m(a,c));a.trigger("change").trigger("changeTime");return!0}function C(a){a=Math.round(a/60);60>Math.abs(a)?a=[a,h.mins]:60==a?a=["1",h.hr]:(a=(a/60).toFixed(1),"."!=h.decimal&&(a=a.replace(".",h.decimal)),a=[a,h.hrs]);return a.join(" ")}function t(a,c){if(null!==a){for(var b=new Date(D.valueOf()+1E3*a),d="",e,f=0;f<c.length;f++)switch(e= c.charAt(f),e){case "a":d+=11<b.getHours()?"pm":"am";break;case "A":d+=11<b.getHours()?"PM":"AM";break;case "g":e=b.getHours()%12;d+=0===e?"12":e;break;case "G":d+=b.getHours();break;case "h":e=b.getHours()%12;0!==e&&10>e&&(e="0"+e);d+=0===e?"12":e;break;case "H":e=b.getHours();d+=9<e?e:"0"+e;break;case "i":e=b.getMinutes();d+=9<e?e:"0"+e;break;case "s":a=b.getSeconds();d+=9<a?a:"0"+a;break;default:d+=e}return d}}function g(a){if(""===a)return null;if(!a||a+0==a)return a;"object"==typeof a&&(a=a.getHours()+ ":"+a.getMinutes()+":"+a.getSeconds());a=a.toLowerCase();var c;-1===a.indexOf(":")?(c=a.match(/^([0-9]):?([0-5][0-9])?:?([0-5][0-9])?\s*([pa]?)m?$/))||(c=a.match(/^([0-2][0-9]):?([0-5][0-9])?:?([0-5][0-9])?\s*([pa]?)m?$/)):c=a.match(/^(\d{1,2})(?::([0-5][0-9]))?(?::([0-5][0-9]))?\s*([pa]?)m?$/);if(!c)return null;a=parseInt(1*c[1],10);return 3600*(c[4]?12==a?"p"==c[4]?12:0:a+("p"==c[4]?12:0):a)+60*(1*c[2]||0)+(1*c[3]||0)}var D=new Date(1970,1,1,0,0,0),E={className:null,minTime:null,maxTime:null,durationTime:null, step:30,showDuration:!1,timeFormat:"g:ia",scrollDefaultNow:!1,scrollDefaultTime:!1,selectOnBlur:!1,disableTouchKeyboard:!0,forceRoundTime:!1,appendTo:"body",disableTimeRanges:[],closeOnWindowScroll:!1},h={decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},j={init:function(a){return this.each(function(){var c=f(this);if("SELECT"==c[0].tagName){for(var b={type:"text",value:c.val()},d=c[0].attributes,e=0;e<d.length;e++)b[d[e].nodeName]=d[e].nodeValue;b=f("<input />",b);c.replaceWith(b);c=b}b=f.extend({},E); a&&(b=f.extend(b,a));b.lang&&(h=f.extend(h,b.lang));b=y(b);c.data("timepicker-settings",b);c.prop("autocomplete","off");c.on("click.timepicker focus.timepicker",j.show);c.on("blur.timepicker",z);c.on("keydown.timepicker",A);c.on("keyup.timepicker",B);c.addClass("ui-timepicker-input");z.call(c.get(0))})},show:function(){var a=f(this),c=a.data("timepicker-settings");"ontouchstart"in document&&c.disableTouchKeyboard&&a.blur();var b=a.data("timepicker-list");if(!a.prop("readonly")){if(!b||0===b.length){var b= a.data("timepicker-settings"),d=a.data("timepicker-list");d&&d.length&&(d.remove(),a.data("timepicker-list",!1));var d=f("<ul />",{"class":"ui-timepicker-list"}),e=f("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});e.css({display:"none",position:"absolute"}).append(d);b.className&&e.addClass(b.className);(null!==b.minTime||null!==b.durationTime)&&b.showDuration&&e.addClass("ui-timepicker-with-duration");var k=null!==b.durationTime?b.durationTime:b.minTime,h=null!==b.minTime?b.minTime:0,s= null!==b.maxTime?b.maxTime:h+86400-1;s<=h&&(s+=86400);for(var m=b.disableTimeRanges,n=m.shift();h<=s;h+=60*b.step){var p=h%86400,q=f("<li />");q.data("time",p);q.text(t(p,b.timeFormat));if((null!==b.minTime||null!==b.durationTime)&&b.showDuration){var x=f("<span />");x.addClass("ui-timepicker-duration");x.text(" ("+C(h-k)+")");q.append(x)}n&&(p>=n[0]&&p<n[1]?q.addClass("ui-timepicker-disabled"):p>=n[1]&&(n=m.shift()));d.append(q)}e.data("timepicker-input",a);a.data("timepicker-list",e);b=b.appendTo; "string"===typeof b?b=f(b):"function"===typeof b&&(b=b(a));b.append(e);v(a,d);d.on("click","li",function(){a.off("focus.timepicker");a.on("focus.timepicker-ie-hack",function(){a.off("focus.timepicker-ie-hack");a.on("focus.timepicker",j.show)});a[0].focus();d.find("li").removeClass("ui-timepicker-selected");f(this).addClass("ui-timepicker-selected");w(a)&&e.hide()});b=a.data("timepicker-list")}if(!b.is(":visible")){j.hide();b.show();a.offset().top+a.outerHeight(!0)+b.outerHeight()>f(window).height()+ f(window).scrollTop()?b.offset({left:a.offset().left+parseInt(b.css("marginLeft").replace("px",""),10),top:a.offset().top-b.outerHeight()+parseInt(b.css("marginTop").replace("px",""),10)}):b.offset({left:a.offset().left+parseInt(b.css("marginLeft").replace("px",""),10),top:a.offset().top+a.outerHeight()+parseInt(b.css("marginTop").replace("px",""),10)});k=b.find(".ui-timepicker-selected");k.length||(l(a)?k=r(a,b,g(l(a))):c.scrollDefaultNow?k=r(a,b,g(new Date)):!1!==c.scrollDefaultTime&&(k=r(a,b,g(c.scrollDefaultTime)))); k&&k.length?(k=b.scrollTop()+k.position().top-k.outerHeight(),b.scrollTop(k)):b.scrollTop(0);if("ontouchstart"in document)f("body").on("touchstart.ui-timepicker",u);else if(f("body").on("mousedown.ui-timepicker",u),c.closeOnWindowScroll)f(window).on("scroll.ui-timepicker",u);a.trigger("showTimepicker")}}},hide:function(){f(".ui-timepicker-wrapper:visible").each(function(){var a=f(this),c=a.data("timepicker-input"),b=c.data("timepicker-settings");b&&b.selectOnBlur&&w(c);a.hide();c.trigger("hideTimepicker")})}, option:function(a,c){var b=this.data("timepicker-settings"),d=this.data("timepicker-list");if("object"==typeof a)b=f.extend(b,a);else if("string"==typeof a&&"undefined"!=typeof c)b[a]=c;else if("string"==typeof a)return b[a];b=y(b);this.data("timepicker-settings",b);d&&(d.remove(),this.data("timepicker-list",!1));return this},getSecondsFromMidnight:function(){return g(l(this))},getTime:function(){var a=new Date;a.setHours(0,0,0,0);return new Date(a.valueOf()+1E3*g(l(this)))},setTime:function(a){a= t(g(a),this.data("timepicker-settings").timeFormat);m(this,a)},remove:function(){this.hasClass("ui-timepicker-input")&&(this.removeAttr("autocomplete","off"),this.removeClass("ui-timepicker-input"),this.removeData("timepicker-settings"),this.off(".timepicker"),this.data("timepicker-list")&&this.data("timepicker-list").remove(),this.removeData("timepicker-list"))}};f.fn.timepicker=function(a){if(j[a])return j[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return j.init.apply(this, arguments);f.error("Method "+a+" does not exist on jQuery.timepicker")}});