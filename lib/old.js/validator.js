function luhn_check(b){for(var e=b.replace(/\D/g,"").length,a=e%2,c=0,d=0;d<e;d++){var f=b.charAt(d);d%2==a&&(f*=2,9<f&&(f-=9));c+=parseInt(f,10)}return 0==c%10?!0:!1}function in_array(b,e,a){var c=!1,d;a=!!a;for(d in e)if(a&&e[d]===b||!a&&e[d]==b){c=!0;break}return c} function Validator(b){this.fObj=document.forms[b];var e=0<arguments.length?arguments[1]:!1;if(!this.fObj)return console.error("Error: could not get form object "+b),!1;this.fObj.onsubmit?(this.fObj.old_onsubmit=this.fObj.onsubmit,this.fObj.onsubmit=null):this.fObj.old_onsubmit=null;this.vElements=[];e?this.fObj.trigger=form_submit_handler:this.fObj.onsubmit=form_submit_handler;this.addValidation=add_validation;this.removeValidation=remove_validation;this.clearAllValidations=clear_all_validations; this.clearValidations=clear_validations;this.restoreValidations=restore_validations;return!0}function clear_all_validations(){for(var b=0;b<this.fObj.elements.length;b++)this.fObj.elements[b].vSet=null}function clear_validations(b,e){for(var a=start=e?e:0;a<this.fObj.elements.length;a++)this.fObj.elements[a].val&&in_array(this.fObj.elements[a].val.vSet[0][0],b)&&(this.fObj.elements[a].val.oldSet=this.fObj.elements[a].val.vSet,this.fObj.elements[a].val.vSet=null)} function restore_validations(b,e){for(var a=start=e?e:0;a<this.fObj.elements.length;a++)this.fObj.elements[a].val&&this.fObj.elements[a].val.oldSet&&(this.fObj.elements[a].val.vSet=this.fObj.elements[a].val.oldSet)}function form_submit_handler(){for(var b=0;b<this.elements.length;b++)if(this.elements[b].val&&this.elements[b].val.vSet&&!this.elements[b].val.validate(this))return!1;return!0}function remove_validation(b){(b=this.fObj[b])&&b.val&&(b.val.oldSet=b.val.vSet,b.val.vSet=null)} function add_validation(b,e,a){if(this.fObj){var c=this.fObj[b];c?c.val?c.val.oldSet?c.val.vSet=c.val.oldSet:c.val.add(b,e,a):(c.val=new Val,c.val.add(b,e,a)):(elementArray=b.split("|"),1<elementArray.length?this.fObj[elementArray[0]]&&this.fObj[elementArray[1]]?(this.fObj[elementArray[0]].val||(this.fObj[elementArray[0]].val=new Val),this.fObj[elementArray[0]].val.add(b,e,a)):console.error("Error: Could not get the input objects"):console.error("Error: Could not get the input object named: "+b))}else console.error("Error: the form object is not set properly")} function Val(b,e,a){this.vSet=[];this.add=addVal;this.validate=validate}function addVal(b,e,a){this.vSet[this.vSet.length]=[b,e,a]}function validate(b){for(i=0;i<this.vSet.length;i++)if(!checkValidation(this.vSet[i][0],this.vSet[i][1],this.vSet[i][2],b))return elementArray=this.vSet[i][0].split("|"),b[elementArray[0]].focus(),!1;return!0} function checkValidation(b,e,a,c){e=e.split("=");command=e[0];cmdvalue=1<e.length?e[1]:"";e={alnum:/[^A-Za-z0-9\ ]/,alnumhyphen:/[^A-Za-z0-9\-_]/,alpha:/[^A-Za-z]/,cc:/^(3[47]|4|5[1-5]|6011)/,csv:/[^-a-zA-Z0-9,\s]/,custom:/[^A-Za-z0-9\042\047\055\057\ _$.,!?()]/,date:/^[\d]{4}-[\d]{2}-[\d]{2}$/,email:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,"float":/[^0-9\.]/,img:/^[0-9A-Za-z_ \-]+(.[jJ][pP][gG]|.[jJ][pP][eE][gG]|.[gG][iI][fF]|.[pP][nN][gG])$/, ip:/^(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:[.](?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}$/,num:/[^0-9]/,phone:/[^0-9\- ()]/,URL:/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,4}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/,zip:/[^-0-9]/};switch(command){case "alnum":case "alphanumeric":var d=c[b].value.search(e.alnum);if(0<c[b].value.length&&0<=d)return a&& 0!=a.length||(a=b+" must be alpha-numeric"),alert(a+"\n [Error character position "+eval(d+1)+"]"),!1;break;case "alnumhyphen":d=c[b].value.search(e.alnumhyphen);if(0<c[b].value.length&&0<=d)return a&&0!=a.length||(a=b+" may only contain alpha-numeric, hyphen and underscore characters"),alert(a+"\n [Error character position "+eval(d+1)+"]"),!1;break;case "alphabetic":case "alpha":d=c[b].value.search(e.alpha);if(0<c[b].value.length&&0<=d)return a&&0!=a.length||(a=b+" may only contain letters (no symbols or numbers)"), alert(a+"\n [Error character position "+eval(d+1)+"]"),!1;break;case "cc":case "credit":case "creditcard":a=c[b].value.replace(/\D/g,"");b=a.length;c=a[0];if(null!=e.cc.exec(a)){switch(c){case "4":if(13!=b&&16!=b)return alert("The credit card number you entered is not valid. Please try again."),!1;d=1;break;case "5":if(16!=b)return alert("The credit card number you entered is not valid. Please try again."),!1;d=2;break;case "6":if(16!=b)return alert("The credit card number you entered is not valid. Please try again."), !1;d=3;break;case "3":if(15!=b)return alert("The credit card number you entered is not valid. Please try again."),!1;d=4}if(!luhn_check(a))return alert("The credit card number you entered is not valid. Please try again."),!1;"undefined"!=typeof d&&(document.getElementById("sCCType").options[d].selected=!0)}else return alert("The credit card number you entered is not valid. Please try again."),!1;break;case "csv":d=c[b].value.search(e.csv);if(0<c[b].value.length&&0<=d)return a&&0!=a.length||(a=b+" may only contain alpha-numeric characters, '-' and '_', separated by commas"), alert(a),!1;break;case "custom":d=c[b].value.search(e.custom);if(0<c[b].value.length&&0<=d)return a&&0!=a.length||(a=b+" may only contain alpha-numeric, {'}, {,}, {.}, {&}, {/}, {-}, {\"}, {?}, {(}, {)}, {_} and {!} characters"),alert(a+"\n [Error character position "+eval(d+1)+"]"),!1;break;case "date":if(0<c[b].value.length&&(d=c[b].value.match(e.date),null==d))return a&&0!=a.length||(a=b+" must contain a valid date"),alert(a),!1;break;case "email":if(0<c[b].value.length&&(d=c[b].value.match(e.email), null==d))return a&&0!=a.length||(a=b+" must contain a valid email address"),alert(a),!1;break;case "extension":case "ext":d=cmdvalue.split("|");c=c[b].value.split(".")[c[b].value.split(".").length-1].toLowerCase();if(-1==d.indexOf(c))return a&&0!=a.length||(a=b+" may only contain the following file types: "+d),alert(a+'\n[Current file type: "'+c+'" ]'),!1;break;case "float":d=c[b].value.search(e["float"]);if(0<c[b].value.length&&0<=d)return a&&0!=a.length||(a=b+" may only contain numbers and a period"), alert(a+"\n [Error character position "+eval(d+1)+"]"),!1;break;case "gt":case "greaterthan":if(isNaN(c[b].value))return alert(b+" must be numeric"),!1;if(eval(c[b].value)<=eval(cmdvalue))return a&&0!=a.length||(a=b+" must contain a number greater than "+cmdvalue),alert(a),!1;break;case "image":case "img":d=c[b].value.split("\\")[c[b].value.split("\\").length-1].match(e.img);if(0<c[b].value.length&&0<=d)return a&&0!=a.length||(a=b+" may only hold an image with extensions jpg, jpeg, gif or png."), alert(a+"\n [Error character position "+eval(d+1)+"]"),!1;break;case "ip":d=c[b].value.search(e.ip);if(0<c[b].value.length&&0<=d)return a&&0!=a.length||(a=b+" must be a number"),alert(a+"\n [Error character position "+eval(d+1)+"]"),!1;break;case "lt":case "lessthan":if(isNaN(c[b].value))return alert(b+" must be numeric"),!1;if(eval(c[b].value)>=eval(cmdvalue))return a&&0!=a.length||(a=b+" must contain a number less than "+cmdvalue),alert(a),!1;break;case "match":b=b.split("|");if(c[b[0]].value!= c[b[1]].value)return a&&0!=a.length||(a=b[0]+" and "+b[1]+" must match"),alert(a),!1;break;case "maxlength":case "maxlen":if(eval(c[b].value.length)>eval(cmdvalue))return a&&0!=a.length||(a=b+" may not be longer than "+cmdvalue+" characters"),alert(a+"\n[Current length = "+c[b].value.length+" ]"),!1;break;case "minlength":case "minlen":if(eval(c[b].value.length)<eval(cmdvalue))return a&&0!=a.length||(a=b+" may not be shorter than "+cmdvalue+" characters"),alert(a+"\n[Current length = "+c[b].value.length+ " ]"),!1;break;case "num":case "numeric":d=c[b].value.search(e.num);if(0<c[b].value.length&&0<=d)return a&&0!=a.length||(a=b+" must be a number"),alert(a+"\n [Error character position "+eval(d+1)+"]"),!1;break;case "phone":d=c[b].value.search(e.phone);if(0<c[b].value.length&&0<=d)return a&&0!=a.length||(a=b+" must contain a valid phone number"),alert(a+"\n [Error character position "+eval(d+1)+"]"),!1;break;case "regexp":if(0<c[b].value.length&&!c[b].value.match(cmdvalue))return a&&0!=a.length||(a= b+" contains invalid characters"),alert(a),!1;break;case "req":case "required":if(0==eval(c[b].value.length)||"checkbox"==c[b].type&&!1==c[b].checked)return a&&0!=a.length||(a=b+" is a required field"),alert(a),!1;break;case "URL":if(0<c[b].value.length&&(d=c[b].value.match(e.URL),null==d))return a&&0!=a.length||(a=b+" must contain a valid URL"),alert(a),!1;break;case "val":if(c[b].value!=cmdvalue&&0<c[b].value.length)return a&&0!=a.length||(a=b+'" must contain the following value "'+cmdvalue+'"'), alert(a),!1;break;case "!val":if(c[b].value==cmdvalue&&0<c[b].value.length)return a&&0!=a.length||(a=b+'" must not contain the following value "'+cmdvalue+'"'),alert(a),!1;break;case "zip":if(d=c[b].value.search(e.zip),0<c[b].value.length&&0<=d)return a&&0!=a.length||(a=b+" must contain a valid zip code"),alert(a+"\n [Error character position "+eval(d+1)+"]"),!1}return!0};