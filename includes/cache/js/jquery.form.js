
(function(d){function m(){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}d.fn.ajaxSubmit=function(a){function c(b){function g(){var a=j.attr("target"),b=j.attr("action");c.setAttribute("target",k);c.getAttribute("method")!="POST"&&c.setAttribute("method","POST");c.getAttribute("action")!=e.url&&c.setAttribute("action",e.url);e.skipEncodingOverride||j.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});e.timeout&&(s=setTimeout(function(){p=!0;i(!0)},e.timeout));var f=[];try{if (e.extraData)for (var h in e.extraData)f.push(d('<input type="hidden" name="'+h+'" value="'+e.extraData[h]+'" />').appendTo(c)[0]);e.iframeTarget||(o.appendTo("body"),n.attachEvent?n.attachEvent("onload",i):n.addEventListener("load",i,!1));c.submit()}finally{c.setAttribute("action",b),a?c.setAttribute("target",a):j.removeAttr("target"),d(f).remove()}}function i(a){if (!h.aborted&&!t)if (a===!0&&h)h.abort("timeout");else if ((a=n.contentWindow?n.contentWindow.document:n.contentDocument?n.contentDocument:n.document)&&a.location.href!=e.iframeSrc||p){n.detachEvent?n.detachEvent("onload",i):n.removeEventListener("load",i,!1);var b="success",c;try{if (p)throw"timeout";var f=e.dataType=="xml"||a.XMLDocument||d.isXMLDoc(a);m("isXml="+f);if (!f&&window.opera&&(a.body==null||a.body.innerHTML=="")&&--x){m("requeing onLoad callback, DOM not available");setTimeout(i,250);return}var g=a.body?a.body:a.documentElement;h.responseText=g?g.innerHTML:null;h.responseXML=a.XMLDocument?a.XMLDocument:a;if (f)e.dataType="xml";h.getResponseHeader=function(a){return{"content-type":e.dataType}[a]};if (g)h.status=Number(g.getAttribute("status"))||h.status,h.statusText=g.getAttribute("statusText")||h.statusText;var j=/(json|script|text)/.test((e.dataType||"").toLowerCase());if (j||e.textarea){var k=a.getElementsByTagName("textarea")[0];if (k)h.responseText=k.value,h.status=Number(k.getAttribute("status"))||h.status,h.statusText=k.getAttribute("statusText")||h.statusText;else if (j){var q=a.getElementsByTagName("pre")[0],r=a.getElementsByTagName("body")[0];if (q)h.responseText=q.textContent?q.textContent:q.innerHTML;else if (r)h.responseText=r.innerHTML}}else if (e.dataType=="xml"&&!h.responseXML&&h.responseText!=null)h.responseXML=y(h.responseText);try{u=z(h,e.dataType,e)}catch(w){b="parsererror",h.error=c=w||b}}catch(v){m("error caught",v),b="error",h.error=c=v||b}h.aborted&&(m("upload aborted"),b=null);h.status&&(b=h.status>=200&&h.status<300||h.status===304?"success":"error");if (b==="success")e.success&&e.success.call(e.context,u,"success",h),l&&d.event.trigger("ajaxSuccess",[h,e]);else if (b){if (c==void 0)c=h.statusText;e.error&&e.error.call(e.context,h,b,c);l&&d.event.trigger("ajaxError",[h,e,c])}l&&d.event.trigger("ajaxComplete",[h,e]);l&&!--d.active&&d.event.trigger("ajaxStop");e.complete&&e.complete.call(e.context,h,b);t=!0;e.timeout&&clearTimeout(s);setTimeout(function(){e.iframeTarget||o.remove();h.responseXML=null},100)}}var c=j[0],f,e,l,k,o,n,h,p,s;if (b)for (f=0;f<b.length;f++)d(c[b[f].name]).attr("disabled",!1);if (d(":input[name=submit],:input[id=submit]",c).length)alert('Error: Form elements must not have name or id of "submit".');else if (e=d.extend(!0,{},d.ajaxSettings,a),e.context=e.context||e,k="jqFormIO"+(new Date).getTime(),e.iframeTarget?(o=d(e.iframeTarget),f=o.attr("name"),f==null?o.attr("name",k):k=f):(o=d('<iframe name="'+k+'" src="'+e.iframeSrc+'" />'),o.css({position:"absolute",top:"-1000px",left:"-1000px"})),n=o[0],h={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){a=a==="timeout"?"timeout":"aborted";m("aborting upload... "+a);this.aborted=1;o.attr("src",e.iframeSrc);h.error=a;e.error&&e.error.call(e.context,h,a,a);l&&d.event.trigger("ajaxError",[h,e,a]);e.complete&&e.complete.call(e.context,h,a)}},(l=e.global)&&!d.active++&&d.event.trigger("ajaxStart"),l&&d.event.trigger("ajaxSend",[h,e]),e.beforeSend&&e.beforeSend.call(e.context,h,e)===!1)e.global&&d.active--;else if (!h.aborted){if (b=c.clk)if ((f=b.name)&&!b.disabled)if (e.extraData=e.extraData||{},e.extraData[f]=b.value,b.type=="image")e.extraData[f+".x"]=c.clk_x,e.extraData[f+".y"]=c.clk_y;e.forceSync?g():setTimeout(g,10);var u,x=50,t,y=d.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&b.documentElement.nodeName!="parsererror"?b:null},A=d.parseJSON||function(a){return window.eval("("+a+")")},z=function(a,b,e){var c=a.getResponseHeader("content-type")||"",g=b==="xml"||!b&&c.indexOf("xml")>=0,a=g?a.responseXML:a.responseText;g&&a.documentElement.nodeName==="parsererror"&&d.error&&d.error("parsererror");e&&e.dataFilter&&(a=e.dataFilter(a,b));typeof a==="string"&&(b==="json"||!b&&c.indexOf("json")>=0?a=A(a):(b==="script"||!b&&c.indexOf("javascript")>=0)&&d.globalEval(a));return a}}}if (!this.length)return m("ajaxSubmit: skipping submit process - no element selected"),this;typeof a=="function"&&(a={success:a});var g=this.attr("action");(g=(g=typeof g==="string"?d.trim(g):"")||window.location.href||"")&&(g=(g.match(/^([^#]+)/)||[])[1]);a=d.extend(!0,{url:g,success:d.ajaxSettings.success,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);g={};this.trigger("form-pre-serialize",[this,a,g]);if (g.veto)return m("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if (a.beforeSerialize&&a.beforeSerialize(this,a)===!1)return m("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var b,f,i=this.formToArray(a.semantic);if (a.data)for (b in a.extraData=a.data,a.data)if (a.data[b]instanceof Array)for (var l in a.data[b])i.push({name:b,value:a.data[b][l]});else f=a.data[b],f=d.isFunction(f)?f():f,i.push({name:b,value:f});if (a.beforeSubmit&&a.beforeSubmit(i,this,a)===!1)return m("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[i,this,a,g]);if (g.veto)return m("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;b=d.param(i);a.type.toUpperCase()=="GET"?(a.url+=(a.url.indexOf("?")>=0?"&":"?")+b,a.data=null):a.data=b;var j=this,k=[];a.resetForm&&k.push(function(){j.resetForm()});a.clearForm&&k.push(function(){j.clearForm()});if (!a.dataType&&a.target){var p=a.success||function(){};k.push(function(b){var c=a.replaceTarget?"replaceWith":"html";d(a.target)[c](b).each(p,arguments)})}else a.success&&k.push(a.success);a.success=function(b,c,d){for (var g=a.context||a,f=0,e=k.length;f<e;f++)k[f].apply(g,[b,c,d||j,j])};b=d("input:file",this).length>0;l=j.attr("enctype")=="multipart/form-data"||j.attr("encoding")=="multipart/form-data";a.iframe!==!1&&(b||a.iframe||l)?a.closeKeepAlive?d.get(a.closeKeepAlive,function(){c(i)}):c(i):d.ajax(a);this.trigger("form-submit-notify",[this,a]);return this};d.fn.ajaxForm=function(a){if (this.length===0){var c={s:this.selector,c:this.context};if (!d.isReady&&c.s)return m("DOM not ready, queuing ajaxForm"),d(function(){d(c.s,c.c).ajaxForm(a)}),this;m("terminating; zero elements found by selector"+(d.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(c){c.isDefaultPrevented()||(c.preventDefault(),d(this).ajaxSubmit(a))}).bind("click.form-plugin",function(a){var b=a.target,c=d(b);if (!c.is(":submit,input:image")){b=c.closest(":submit");if (b.length==0)return;b=b[0]}var i=this;i.clk=b;if (b.type=="image")a.offsetX!=void 0?(i.clk_x=a.offsetX,i.clk_y=a.offsetY):typeof d.fn.offset=="function"?(c=c.offset(),i.clk_x=a.pageX-c.left,i.clk_y=a.pageY-c.top):(i.clk_x=a.pageX-b.offsetLeft,i.clk_y=a.pageY-b.offsetTop);setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)})};d.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};d.fn.formToArray=function(a){var c=[];if (this.length===0)return c;var g=this[0],b=a?g.getElementsByTagName("*"):g.elements;if (!b)return c;var f,i,l,j,k,m;f=0;for (k=b.length;f<k;f++)if (i=b[f],l=i.name)if (a&&g.clk&&i.type=="image")!i.disabled&&g.clk==i&&(c.push({name:l,value:d(i).val()}),c.push({name:l+".x",value:g.clk_x},{name:l+".y",value:g.clk_y}));else if ((j=d.fieldValue(i,!0))&&j.constructor==Array){i=0;for (m=j.length;i<m;i++)c.push({name:l,value:j[i]})}else j!==null&&typeof j!="undefined"&&c.push({name:l,value:j});if (!a&&g.clk&&(a=d(g.clk),b=a[0],(l=b.name)&&!b.disabled&&b.type=="image"))c.push({name:l,value:a.val()}),c.push({name:l+".x",value:g.clk_x},{name:l+".y",value:g.clk_y});return c};d.fn.formSerialize=function(a){return d.param(this.formToArray(a))};d.fn.fieldSerialize=function(a){var c=[];this.each(function(){var g=this.name;if (g){var b=d.fieldValue(this,a);if (b&&b.constructor==Array)for (var f=0,i=b.length;f<i;f++)c.push({name:g,value:b[f]});else b!==null&&typeof b!="undefined"&&c.push({name:this.name,value:b})}});return d.param(c)};d.fn.fieldValue=function(a){for (var c=[],g=0,b=this.length;g<b;g++){var f=d.fieldValue(this[g],a);f===null||typeof f=="undefined"||f.constructor==Array&&!f.length||(f.constructor==Array?d.merge(c,f):c.push(f))}return c};d.fieldValue=function(a,c){var g=a.name,b=a.type,f=a.tagName.toLowerCase();c===void 0&&(c=!0);if (c&&(!g||a.disabled||b=="reset"||b=="button"||(b=="checkbox"||b=="radio")&&!a.checked||(b=="submit"||b=="image")&&a.form&&a.form.clk!=a||f=="select"&&a.selectedIndex==-1))return null;if (f=="select"){var i=a.selectedIndex;if (i<0)return null;for (var g=[],f=a.options,l=(b=b=="select-one")?i+1:f.length,i=b?i:0;i<l;i++){var j=f[i];if (j.selected){var k=j.value;k||(k=j.attributes&&j.attributes.value&&!j.attributes.value.specified?j.text:j.value);if (b)return k;g.push(k)}}return g}return d(a).val()};d.fn.clearForm=function(){return this.each(function(){d("input,select,textarea",this).clearFields()})};d.fn.clearFields=d.fn.clearInputs=function(){return this.each(function(){var a=this.type,c=this.tagName.toLowerCase();if (a=="text"||a=="password"||c=="textarea")this.value="";else if (a=="checkbox"||a=="radio")this.checked=!1;else if (c=="select")this.selectedIndex=-1})};d.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})};d.fn.enable=function(a){a===void 0&&(a=!0);return this.each(function(){this.disabled=!a})};d.fn.selected=function(a){a===void 0&&(a=!0);return this.each(function(){var c=this.type;if (c=="checkbox"||c=="radio")this.checked=a;else if (this.tagName.toLowerCase()=="option")c=d(this).parent("select"),a&&c[0]&&c[0].type=="select-one"&&c.find("option").selected(!1),this.selected=a})}})(jQuery);